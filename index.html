<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<title>FY25 Chelsea Flood Wall — Job Sheet</title>
<meta name="viewport" content="width=device-width, initial-scale=1">
<style>
  :root{
    --ink:#111; --muted:#444; --line:#1a1a1a; --gray:#666; --bg:#fff;
    --bar:#e9ecef; --pad:12px;
  }
  *{box-sizing:border-box}
  html,body{margin:0;background:#f5f5f5;color:var(--ink);font-family: ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial, "Noto Sans", sans-serif;}
  .sheet{
    width: 860px; margin:24px auto; background:var(--bg);
    box-shadow: 0 4px 28px rgba(0,0,0,.08);
    border: 2px solid #000; padding: 18px;
  }
   /* Small utility to force baseline alignment for these two rows */
  .check.check-baseline{
    display: flex !important;
    align-items: baseline !important; /* key: align the line with the label baseline */
    gap: 8px;
    margin: 6px 0;
  }

  /* The little blank line (short, for 1–2 digits) */
  .short-blank {
    display: inline-block;
    width: 34px;                 /* change to 30–50px to adjust length */
    border-bottom: 1px solid #000;
    margin-right: 6px;
    line-height: 1;
    min-height: 0.9em;           /* ensures the border renders at the right height */
    vertical-align: baseline;
    /* keep it visually empty but rendered */
    text-align: center;
  }

  /* make sure the label sits inline and uses same baseline */
  .check.check-baseline label {
    display: inline-block;
    margin: 0;
    vertical-align: baseline;
  }
  .title-row{
    display:flex; justify-content:space-between; align-items:flex-end; gap:8px; margin-bottom:6px;
  }
  .title h1{font-size:20px; margin:0 0 4px 0; text-transform:uppercase; letter-spacing:.3px}
  .title small{color:var(--gray)}
  .hdr-grid{
    display:grid; grid-template-columns: 1.2fr 1fr 1fr 1fr; gap:10px; margin:8px 0 14px;
  }
  .linefield{
    border-bottom:1.5px solid #000; min-height:22px; padding:2px 6px; font-size:14px;
  }
  .linefield input{
    width:100%; border:0; outline:0; font:inherit; background:transparent;
  }
  .bar{background:var(--bar); border:1.5px solid #000; padding:6px 10px; font-weight:700; text-transform:uppercase; margin-top:10px;}
  .block{
    border:1.5px solid #000; border-top:0;
    display:grid; grid-template-columns: 1.5fr 1.2fr; gap:0; 
  }
  .col{padding: var(--pad); border-right:1.5px solid #000;}
  .col:last-child{border-right:0}
  .inv-head{font-weight:700; margin-bottom:8px}
  .invline{display:grid; grid-template-columns: 22px 1fr auto; align-items:center; gap:8px; padding:2px 0;}
  .invline input[type="text"]{
    border:0; border-bottom:1px solid #000; width:120px; background:transparent; font:inherit;
  }
  .amt{min-width:110px; text-align:right; font-variant-numeric: tabular-nums;}
  .check{display:flex; gap:8px; align-items:flex-start; margin:6px 0;}
  .check input{transform: translateY(2px)}
  .muted{color:var(--muted); font-size:12px}
  .tight{line-height:1.15}
  .two-col{columns:2; column-gap:18px}
  .small{font-size:12px}
  .right{float:right}
  .sumrow{display:flex; justify-content:flex-end; gap:12px; margin-top:6px; font-weight:700}
  .sumrow .v{min-width:140px; text-align:right; font-variant-numeric: tabular-nums;}
  @media print{
    body{background:#fff}
    .sheet{box-shadow:none; margin:0; width:auto; border:2px solid #000}
  }
  /* Tiny helpers to echo the scanned look */
  .underscore{border-bottom:1px solid #000; display:inline-block; min-width:140px; height:18px; vertical-align:baseline}
  .section-note{border-top:1px dashed #aaa; margin-top:8px; padding-top:6px}
</style>
</head>
<body>
<form id="jobForm">
<div class="sheet">

  <!-- Header -->
  <div class="title-row">
    <div class="title">
      <h1>FY25 Chelsea Flood Wall</h1>
      <small>Job Sheet • Auto-calculates from Total Project Budget</small>
    </div>
    <div class="small muted">Print: File → Print (fits Letter/A4)</div>
  </div>

  <div class="hdr-grid">
    <div>
      <div class="small">Artist:</div>
      <div class="linefield"><input id="artist" placeholder=""></div>
    </div>
    <div>
      <div class="small">Program Manager:</div>
      <div class="linefield"><input id="pm" placeholder=""></div>
    </div>
    <div>
      <div class="small">Fiscal Year:</div>
      <div class="linefield"><input id="fy" value="FY25"></div>
    </div>
    <div>
      <div class="small">Project Title:</div>
      <div class="linefield"><input id="proj" value="Chelsea Flood Wall"></div>
    </div>
  </div>

  <div class="hdr-grid">
    <div>
      <div class="small">Total Project Budget ($):</div>
      <div class="linefield"><input id="budget" type="number" step="100" min="0" placeholder="e.g., 192000"></div>
      <div class="small muted" id="budgetEcho"></div>
    </div>
    <div>
      <div class="small">Design Budget (25%)</div>
      <div class="linefield"><span id="designBudget"></span></div>
    </div>
    <div>
      <div class="small">Fabrication Budget (75%)</div>
      <div class="linefield"><span id="fabBudget"></span></div>
    </div>
    </div>

  <!-- HP1 -->
  <div class="bar">HP1 – Design Proposal</div>
  <div class="block">
    <div class="col">
      <div class="inv-head">INVOICE #</div>

      <div class="invline">
        <input type="checkbox">
        <div>HP1&nbsp;INV&nbsp;<input id="a_hp1_input" type="number" step="50" min="0" placeholder=""></div>
        <div class="amt" id="a_hp1">—</div>
      </div>

      <div class="invline">
        <input type="checkbox">
        <div>DP1&nbsp;INV&nbsp;<input type="text" placeholder=""></div>
        <div class="amt" id="a_dp1">—</div>
      </div>
      <div class="invline">
        <input type="checkbox">
        <div>DP2&nbsp;INV&nbsp;<input type="text" placeholder=""></div>
        <div class="amt" id="a_dp2">—</div>
      </div>
      <div class="invline">
        <input type="checkbox">
        <div>DP3&nbsp;INV&nbsp;<input type="text" placeholder=""></div>
        <div class="amt" id="a_dp3">—</div>
      </div>
      <div class="invline">
        <input type="checkbox">
        <div>DP4&nbsp;INV&nbsp;<input type="text" placeholder=""></div>
        <div class="amt" id="a_dp4">—</div>
      </div>

      <div class="section-note small muted tight">
        <strong>Note:</strong> DP payments are percentages of the Design Budget. HP1 is optional honorarium.
      </div>
    </div>
    <div class="col">
      <div class="check check-baseline">
  <span class="short-blank">&nbsp;</span>
  <label>Hours supporting applicants</label>
</div>
      <div class="check"><input type="checkbox"><label>In-progress website page created</label></div>
      <div class="check"><input type="checkbox"><label>Community engagement</label></div>
  <div class="check check-baseline">
  <span class="short-blank">&nbsp;</span>
  <label>Hours supporting finalists</label>
</div>
      <div class="check"><input type="checkbox"><label>Finalists’ honorarium invoices received</label></div>
      <div class="muted small section-note">Trigger: After selection committee approval</div>
    </div>
  </div>

  <!-- DP1 -->
  <div class="bar">DP1 – Contract Artist</div>
  <div class="block">
    <div class="col">
      <div class="inv-head">INVOICE #</div>
      <div class="invline">
        <input type="checkbox">
        <div>PM&nbsp;DP1&nbsp;INV&nbsp;<input type="text" placeholder=""></div>
        <div class="amt"><span class="muted">manual</span></div>
      </div>
      <div class="sumrow small">
        <div class="k">DP1 Amount</div>
        <div class="v" id="sum_dp1">—</div>
      </div>
    </div>
    <div class="col">
      <div class="check"><input type="checkbox"><label>W9 on file</label></div>
      <div class="check"><input type="checkbox"><label>DP1 Artist invoice received</label></div>
      <div class="check"><input type="checkbox"><label>Website updated</label></div>
      <div class="muted small section-note">Trigger: Contract signed, W9 on file, invoice received</div>
    </div>
  </div>

  <!-- DP2 -->
  <div class="bar">DP2 – Schematic Design</div>
  <div class="block">
    <div class="col">
      <div class="inv-head">INVOICE #</div>
      <div class="invline">
        <input type="checkbox">
        <div>PM&nbsp;DP2&nbsp;INV&nbsp;<input type="text" placeholder=""></div>
        <div class="amt"><span class="muted">manual</span></div>
      </div>
      <div class="sumrow small">
        <div class="k">DP2 Amount</div>
        <div class="v" id="sum_dp2">—</div>
      </div>
    </div>
    <div class="col">
      <div class="check"><input type="checkbox"><label>Insurance on file</label></div>
      <div class="check"><input type="checkbox"><label>DP2 Artist invoice received</label></div>
      <div class="check"><input type="checkbox"><label>Website updated</label></div>
      <div class="muted small section-note">Trigger: Schematic design approved by PAOC</div>
    </div>
  </div>

  <!-- DP3 + CP1 combined -->
  <div class="bar">DP3 – Final Design and CP1 – Start Fabrication</div>
  <div class="block">
    <div class="col">
      <div class="inv-head">INVOICE #</div>

      <div class="invline">
        <input type="checkbox">
        <div>PM&nbsp;DP3&nbsp;INV&nbsp;<input type="text" placeholder=""></div>
        <div class="amt"><span class="muted">manual</span></div>
      </div>
      <div class="invline">
        <input type="checkbox">
        <div>PM&nbsp;CP1&nbsp;INV&nbsp;<input type="text" placeholder=""></div>
        <div class="amt"><span class="muted">manual</span></div>
      </div>

      <div class="invline">
        <input type="checkbox">
        <div>CP1&nbsp;INV&nbsp;<input type="text" placeholder=""></div>
        <div class="amt" id="a_cp1">—</div>
      </div>
      <div class="invline">
        <input type="checkbox">
        <div>CP2&nbsp;INV&nbsp;<input type="text" placeholder=""></div>
        <div class="amt" id="a_cp2">—</div>
      </div>
      <div class="invline">
        <input type="checkbox">
        <div>CP3&nbsp;INV&nbsp;<input type="text" placeholder=""></div>
        <div class="amt" id="a_cp3">—</div>
      </div>
      <div class="invline">
        <input type="checkbox">
        <div>CP4&nbsp;INV&nbsp;<input type="text" placeholder=""></div>
        <div class="amt" id="a_cp4">—</div>
      </div>

      <div class="sumrow small">
        <div class="k">CP Contract Subtotal</div>
        <div class="v" id="sum_cp">—</div>
      </div>
    </div>
    <div class="col">
      <div class="check"><input type="checkbox"><label>DP3/CP1 Artist invoice received</label></div>
      <div class="check"><input type="checkbox"><label>Website updated</label></div>
      <div class="muted small section-note">Trigger: Final design approval; authorization to begin fabrication</div>
    </div>
  </div>

  <!-- CP2 -->
  <div class="bar">CP2 – 50%</div>
  <div class="block">
    <div class="col">
      <div class="inv-head">INVOICE #</div>
      <div class="invline">
        <input type="checkbox">
        <div>PM&nbsp;CP2&nbsp;INV&nbsp;<input type="text" placeholder=""></div>
        <div class="amt"><span class="muted">manual</span></div>
      </div>
      <div class="sumrow small">
        <div class="k">CP2 Amount</div>
        <div class="v" id="sum_cp2">—</div>
      </div>
    </div>
    <div class="col">
      <div class="check"><input type="checkbox"><label>CP2 Artist invoice received</label></div>
      <div class="check"><input type="checkbox"><label>Website updated</label></div>
      <div class="muted small section-note">Trigger: Approved at 50% fabrication progress</div>
    </div>
  </div>

  <!-- CP3 -->
  <div class="bar">CP3 – 100%</div>
  <div class="block">
    <div class="col">
      <div class="inv-head">INVOICE #</div>
      <div class="invline">
        <input type="checkbox">
        <div>PM&nbsp;CP3&nbsp;INV&nbsp;<input type="text" placeholder=""></div>
        <div class="amt"><span class="muted">manual</span></div>
      </div>
      <div class="sumrow small">
        <div class="k">CP3 Amount</div>
        <div class="v" id="sum_cp3">—</div>
      </div>
    </div>
    <div class="col">
      <div class="check"><input type="checkbox"><label>CP3 Artist invoice received</label></div>
      <div class="check"><input type="checkbox"><label>Website updated</label></div>
      <div class="muted small section-note">Trigger: Approved at 100% fabrication completion</div>
    </div>
  </div>

  <!-- Final Acceptance -->
  <div class="bar">CP4/DP4 – Final Acceptance</div>
  <div class="block">
    <div class="col">
      <div class="inv-head">INVOICE #</div>
      <div class="invline">
        <input type="checkbox">
        <div>PM&nbsp;DP4&nbsp;INV&nbsp;<input type="text" placeholder=""></div>
        <div class="amt"><span class="muted">manual</span></div>
      </div>
      <div class="invline">
        <input type="checkbox">
        <div>PM&nbsp;CP4&nbsp;INV&nbsp;<input type="text" placeholder=""></div>
        <div class="amt"><span class="muted">manual</span></div>
      </div>
      <div class="sumrow small">
        <div class="k">DP4 Amount</div>
        <div class="v" id="sum_dp4">—</div>
      </div>
      <div class="sumrow small">
        <div class="k">CP4 Amount</div>
        <div class="v" id="sum_cp4">—</div>
      </div>
    </div>
    <div class="col">
      <div class="check"><input type="checkbox"><label>CP4/DP4 Artist invoice received</label></div>
      <div class="check"><input type="checkbox"><label>Exit survey received</label></div>
      <div class="check"><input type="checkbox"><label>Website updated to completed projects</label></div>
      <div class="check"><input type="checkbox"><label>Added to master public art inventory</label></div>
      <div class="muted small section-note">Trigger: Project closeout & acceptance / Artwork installed</div>
    </div>
  </div>

  <!-- Totals -->
  <div style="padding:10px 2px 2px">
    <div class="sumrow">
      <div>Total of Contract Payments</div>
      <div class="v" id="contractTotal">—</div>
    </div>
    <div class="sumrow">
      <div>Honorarium (HP1)</div>
      <div class="v" id="honorTotal">—</div>
    </div>
    <div class="sumrow">
      <div><em>Grand Total</em></div>
      <div class="v" id="grandTotal">—</div>
    </div>
    <div class="small muted" id="matchNote"></div>
  </div>

</div>
<div style="text-align:center; margin-top:20px;">
  <button type="submit">Submit to Google Sheet</button>
</div>
</form>

<script>
  const fmt = new Intl.NumberFormat(undefined,{style:'currency',currency:'USD'});
  const $ = (id)=>document.getElementById(id);

  function recalc(){
    const totalEntered = Number($('budget').value)||0;
    const hp1Invoice   = Number($('a_hp1_input')?.value)||0; // we’ll add an input for HP1 invoice

    // Subtract HP1 from total
    const T = Math.max(totalEntered - hp1Invoice, 0);

    const D = T*0.25, F = T*0.75;

    $('budgetEcho').textContent = totalEntered
      ? `Entered: ${fmt.format(totalEntered)} • After HP1: ${fmt.format(T)}`
      : '';

    $('designBudget').textContent = D? fmt.format(D):'';
    $('fabBudget').textContent    = F? fmt.format(F):'';

    // DP amounts (of Design)
    const dp1 = D*0.25, dp2 = D*0.40, dp3 = D*0.30, dp4 = D*0.05;
    $('a_dp1').textContent = D? fmt.format(dp1):'—';
    $('a_dp2').textContent = D? fmt.format(dp2):'—';
    $('a_dp3').textContent = D? fmt.format(dp3):'—';
    $('a_dp4').textContent = D? fmt.format(dp4):'—';
    $('sum_dp1').textContent = D? fmt.format(dp1):'—';
    $('sum_dp2').textContent = D? fmt.format(dp2):'—';
    $('sum_dp4').textContent = D? fmt.format(dp4):'—';

    // CP amounts (of Fabrication)
    const cp1 = F*0.45, cp2 = F*0.25, cp3 = F*0.25, cp4 = F*0.05;
    $('a_cp1').textContent = F? fmt.format(cp1):'—';
    $('a_cp2').textContent = F? fmt.format(cp2):'—';
    $('a_cp3').textContent = F? fmt.format(cp3):'—';
    $('a_cp4').textContent = F? fmt.format(cp4):'—';
    $('sum_cp').textContent  = F? fmt.format(cp1+cp2+cp3+cp4):'—';
    $('sum_cp2').textContent = F? fmt.format(cp2):'—';
    $('sum_cp3').textContent = F? fmt.format(cp3):'—';
    $('sum_cp4').textContent = F? fmt.format(cp4):'—';

    const contract = dp1+dp2+dp3+dp4+cp1+cp2+cp3+cp4;
    $('contractTotal').textContent = T? fmt.format(contract):'—';
    $('honorTotal').textContent = hp1Invoice ? fmt.format(hp1Invoice) : '—';
    $('grandTotal').textContent = fmt.format(contract+hp1Invoice);

    // Check match
    const diff = Math.abs(totalEntered - (contract+hp1Invoice));
    $('matchNote').textContent = totalEntered
      ? (diff<=0.01 ? 'OK: Contract+HP1 matches entered budget.' : 'Warning: Totals don’t reconcile.')
      : '';
  }

  // add listeners
  $('budget').addEventListener('input', recalc);
  document.addEventListener('input', e=>{
    if(e.target.id==='a_hp1_input') recalc();
  });

// ========= FORM SUBMISSION =========
  document.getElementById('jobForm').addEventListener('submit', async function(e){
    e.preventDefault();

    const data = {
      artist: $('artist').value,
      pm: $('pm').value,
      fy: $('fy').value,
      proj: $('proj').value,
      budget: $('budget').value,
      hp1: $('a_hp1_input')?.value,
      dp1: $('a_dp1').textContent,
      dp2: $('a_dp2').textContent,
      dp3: $('a_dp3').textContent,
      dp4: $('a_dp4').textContent,
      cp1: $('a_cp1').textContent,
      cp2: $('a_cp2').textContent,
      cp3: $('a_cp3').textContent,
      cp4: $('a_cp4').textContent
    };

    const url = "https://script.google.com/macros/s/AKfycbx8ti46ETEfZ2nvWhfxOpNG27HvzySlBbGhi2Bvd2aIILjlHFa768YI5E1g88QPAkg96w/exec"; // <-- paste Google Apps Script web app URL

    try {
      const response = await fetch(url, {
        method: "POST",
        headers: { "Content-Type": "application/json" },
        body: JSON.stringify(data)
      });

      const result = await response.json();
      alert(result.status === "success" ? "Saved to Google Sheet!" : "Error saving.");
    } catch (err) {
      alert("Error: " + err.message);
    }
  });
</script>
</body>
</html>
